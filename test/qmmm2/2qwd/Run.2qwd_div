#!/bin/csh -f
#TEST-PROGRAM sander
#TEST-DESCRIP TO_BE_DEtermined
#TEST-PURPOSE regression, basic
#TEST-STATE   undocumented

set sander = "../../../bin/sander"
if( $?TESTsander ) then
    set sander = $TESTsander
endif

if( $?DO_PARALLEL ) then
    echo "This test not set up for parallel, skipping"
    exit 0
endif

cat > mdin <<EOF
Lysine: 3 cycles minimization, one methylene group QM, has link atoms
 &cntrl
        imin =1, maxcyc = 3, drms=0.005,
        ntpr=1, ntb=0, cut=99.,
        ifqnt=1,igb=6,
 /
 &qmmm
        iqmatoms =  537,  538,  539,  540,  541,  542,  543,  544,  545,  546,
          547,  548,  549,  550,  551,  552,  553,  554,  555,  556,
          557,  558,  559,  560,  561,  562,  563,  564,  565,  566,
          567,  568,  569,  570,  571,  572,  573,  574,  575,  576,
          577,  578,  579,  580,  581,  582,  583,  584,  585,  586,
          587,  588,  589,  590,  591,  592,  593, 1039, 1040, 1041,
         1042, 1043, 1044, 1045, 1046, 1047, 1048, 1049, 1050, 1051,
         1052, 1053, 1054, 1055, 1056, 1057, 1058, 1059, 1060, 1061,
         1062, 1063, 1064, 1065, 1066, 1067, 1068, 1069, 1070, 1071,
         1072, 1073, 1074, 1075, 1076, 1077, 1078, 1124, 1125, 1126,
         1127, 1128, 1129, 1130, 1131, 1132, 1133, 1134, 1135, 1136,
         1137, 1138, 1139, 1140, 1141, 1142, 1143, 1144, 1145, 1146,
         1147, 1148, 1149, 1150, 1151, 1481, 1482, 1483, 1484, 1485,
         1486, 1487, 1488, 1489, 1490, 1491, 1492, 1493, 1494, 1495,
         1496, 1497, 1498, 1499, 1500, 1501, 1502, 1503, 1504, 1505,
         1506, 1507, 1508, 1509, 1510, 1511, 1512, 1513, 1514, 1515,
         1516, 1517, 1518, 1519, 2159, 2160, 2161, 2162, 2163, 2164,
         2165, 2166, 2167, 2168, 2169, 2170, 2171, 2172, 2173, 2174,
         2175, 2176, 2177, 2178, 2179, 2180, 2181, 2197, 2198, 2199,
         2200, 2201, 2202, 2203, 2204, 2205, 2206, 2207, 2208, 2209,
         2210, 2211, 2212, 2213, 2214, 2215, 2216, 2217, 2218, 2219,
         2220, 2221, 2222, 2223, 2224, 2252, 2253, 2254, 2255, 2256,
         2257, 2258, 2259, 2260, 2261, 2262, 2263, 2264, 2265, 2266,
         2267, 2268, 2269, 2270, 2503, 2504, 2505, 2506, 2507, 2508,
         2509, 2510, 2511, 2512, 2513, 2514, 2515, 2516, 2989, 2990,
         2991, 2992, 2993, 2994, 2995, 2996, 2997, 2998, 2999, 3000,
         3001, 3002, 3003, 3004, 3005, 3006, 3007, 3008, 3009, 3010,
         3011, 3012, 3013, 3014, 3015, 3016, 3017, 3018, 3019, 3020,
         3021, 3022, 3209, 3210, 3211, 3212, 3213, 3214, 3215, 3216,
         3217, 3218, 3219, 3220, 3221, 3222, 3223, 3224, 3225, 3226,
         3227, 3228, 3229, 3230, 3231, 3232, 3233, 3234, 3243, 3244,
         3245, 3246, 3247, 3248, 3249, 3250, 3251, 3252, 3253, 3254,
         3255, 3256, 3257, 3258, 3259, 3260, 4381, 4382, 4383, 4384,
         4385, 4386, 4387, 4388, 4389, 4390, 4391, 4392, 4393, 4394,
         4395, 4396, 4397, 4398, 4399, 4400, 4401, 4402, 4403, 4404,
         4405, 4406, 4407, 4408, 4902, 4903, 4904, 4905, 4906, 4907,
         4908, 4909, 4910, 4911, 4912, 4913, 4914, 4915, 4916, 4917,
         4918, 4919, 4920, 4921, 4922, 4923, 4924, 4925, 4926, 2182,
         2183, 3235, 3236, 
        qmtheory=2,
        qmcharge=0,adjust_q=0,
        idc=2
 /   
EOF

set output = 2qwd_div.out

touch dummy
$sander -O -c 2qwd.crd -o $output < dummy || goto error
../../dacdif -t 1 $output.save $output

/bin/rm -f restrt mdin mdinfo dummy
exit(0)

error:
echo "  ${0}:  Program error"
exit(1)
